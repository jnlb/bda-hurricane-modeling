---
title: "BDA Project: Hurricane forecasting in Stan"
author: | 
  | José Miguel Ramírez & Jonas Lindblad
  | Aalto University
output: 
    beamer_presentation:
        incremental: true
header-includes:
  \usepackage{dcolumn}
---

<!-- 1. introduce the problem we are trying to solve -->
## Hurricane introduction

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
knitr::opts_knit$set(root.dir = '..')
```


```{r, include=FALSE}
source("init.r", local = knitr::knit_global())
hurricane <- file.path(getwd(), img_path, "hurricane.jpg")
path <- file.path(getwd(), img_path, "corrplot_delta_small_presentation_centered.png")

pareto_linear_path <- file.path(getwd(), img_path, "pareto_linear.png")
pareto_skew_path <- file.path(getwd(), img_path, "pareto_skew.png")
pareto_variance_path <- file.path(getwd(), img_path, "pareto_variance.png")
```
<!-- note that for syntax reasons there needs to be a space '- ' -->
- Destructive storms occuring in the late summer and fall in the northern hemisphere’s tropical region.   
- Classified by their wind intensity at the eye wall.  
- They can cause extreme levels of flooding and destroy many buildings.  
- Monetary damages and loss of lives increase with an almost exponential character as a function of storm intensity.  

\center

![](`r hurricane`){width=60%}


## Hurricane forecasting basics

- Forecasters predict two quantities: track and intensity
- Two kinds of models: _dynamical_ and _statistical_
    - Dynamical: simulate the laws of physics
    - Statistical: estimate based on historical data
- Dynamical vs. statistical: good at long- and short-range forecasts respectively
- ...but for hurricane forecasts short-range is usually more interesting
- _Rapid intensification_: forecasted better by dynamical models
- This project: a _statistical_ model for _intensity_

<!-- 1.1. needed a longer explanation for this part... -->
## Hurricane forecasting basics: the SHIPS data

The US government forecasting agency, the National Hurricane Center (NHC), uses a large number of models operationally. The models (together: the _model ensemble_) are used together with experienced meteorologists' judgment to provide the official forecast. 

- Surprisingly, the best _single_ (short-range) model is a multiple linear regression!
- The NHC regression model: Statistical Hurricane Intensity Prediction Scheme (SHIPS)
- SHIPS: ~140 covariates, many calculated from data sources more easily available to the NHC
- SHIPS dataset: publically available with no restrictions (link: [SHIPS Development](http://rammb.cira.colostate.edu/research/tropical_cyclones/ships/index.asp))
- ...but the documentation is terrible
- SHIPS: only a point estimate; our project: a predictive distribution

<!-- 1.2-a. an image explaining the variable set we have used -->
## Hurricane forecasting basics: the SHIPS data

<!-- 1.2-b. correlation plot ? -->
## Hurricane forecasting basics: our selection


![](`r path`){width=80%}

<!-- 2. explain the 3 models; visually rather than with text -->
<!-- idea: Kruschke diagrams -->
<!-- https://github.com/rasmusab/distribution_diagrams -->
<!-- we would need 3 different Kruschke diagrams for the models -->
## Intensity change predictive model


<!-- 2.1. some remarks on limits of the model(s) -->
## Model: limitations


<!-- 2.2. model comparison with posterior predictive checks (visually) -->
## Model: posterior predictive checking


<!-- 2.3. data selection comparisons -->
## Model: variables to use


<!-- 2.4. distribution of coefficients (visually) -->
## Model: marginal posteriors of coefficients


<!-- 2.5. special case: bivariate margin of SHRD and CSST? (optional?) -->
## Model: margin of SHRD and CSST


<!-- 3. example forecasts on historical storms -->
## Forecasting


<!-- 3.1.1 compare with other models -->
## Forecasting: Model Comparison (1)

\vspace{0.4cm}

Dataset comparison for the **linear regression model** (LOOCV)  

\vspace{0.1cm}

\begin{table}[!h]
\fontsize{8pt}{12pt}\selectfont
\begin{tabular}{ c c c }
 Dataset & \textbf{elpd\_diff} & \textbf{se\_diff} \\ \hline
 \textbf{\textit{C}} & 0.0 & 0.0 \\  
 \textit{B} & -25.0 & 6.5 \\  
 \textit{A} & -27.4 & 6.3 \\     
\end{tabular}
\end{table}

\vspace{-0.2cm}

\center
![](`r pareto_linear_path`){height=60%}

<!-- 3.1.2 compare with other models -->
## Forecasting: Model Comparison (2)

\vspace{0.4cm}

Dataset comparison for the **skewed regression model** (LOOCV)  

\vspace{0.1cm}

\begin{table}[!h]
\fontsize{8pt}{12pt}\selectfont
\begin{tabular}{ c c c }
 Dataset & \textbf{elpd\_diff} & \textbf{se\_diff} \\ \hline
 \textbf{\textit{C}} & 0.0 & 0.0 \\  
 \textit{B} & -23.2 & 6.2 \\  
 \textit{A} & -28.7 & 6.2 \\     
\end{tabular}
\end{table}


\vspace{-0.2cm}
\center
![](`r pareto_skew_path`){height=60%}

<!-- 3.1.3 compare with other models -->
## Forecasting: Model Comparison (3)

\vspace{0.4cm}

Dataset comparison for the **Changing variance model** (LOOCV)  

\vspace{0.1cm}  

\begin{table}[!h]
\fontsize{8pt}{12pt}\selectfont
\begin{tabular}{ c c c }
 Dataset & \textbf{elpd\_diff} & \textbf{se\_diff} \\ \hline
 \textbf{\textit{C}} & 0.0 & 0.0 \\  
 \textit{B} & -32.6 & 8.2 \\  
 \textit{A} & -37.1 & 8.2 \\     
\end{tabular}
\end{table}


\vspace{-0.2cm}
\center
![](`r pareto_variance_path`){height=60%}

<!-- 3.1.4 compare with other models -->
## Forecasting: Model Comparison (4)

Model comparison using the Dataset C (LOOCV) 
\vspace{1cm}

\begin{table}[!h]
\renewcommand{\arraystretch}{1.25}
\begin{tabular}{ c c c }
 Model & \textbf{elpd\_diff} & \textbf{se\_diff} \\ \hline
 \textbf{Variance} & 0.0 & 0.0 \\  
 Skew & -176.3 & 27.8 \\  
 Linear & -205.5 & 34.9 \\     
\end{tabular}
\end{table}



<!-- 3.2. try looking for historical NHC predictions? (can be skimmed incase of time running out) -->
## Forecasting: what about the NHC?


<!-- 4. Final section -->
## Problems to solve & development ideas

- variable selection in full SHIPS dataset
- more time series autoregressive components
- use LGEM model (will explain)


<!-- 4.1. Conclusions  -->
## Conclusions & contact info
<!-- don't put your email address directly : github crawlers will find it and send you spam -->


<!-- 4.2 Extra material -->
## Additional information

<!-- We need to consider what questions the TAs are likely to ask -->

<!-- Consider including an image which explains how Hurricanes form -->


<!-- EXTRA: beamer syntax tutorial below -->
## R Markdown

This is an R Markdown presentation. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document.

## Slide with Bullets

- Bullet 1
- Bullet 2
- Bullet 3

## Slide with R Output

```{r cars, echo = TRUE}
summary(cars)
```

## Slide with Plot

```{r pressure}
plot(pressure)
```

